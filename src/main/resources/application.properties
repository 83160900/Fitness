spring.application.name=Fitness

# Database configuration for Railway / Postgres
# Priorizamos variaveis do Railway e forcamos sslmode=require para evitar erros de conexao
# Adicionamos suporte a variacoes comuns como POSTGRES_DB (usado no add-on do Railway)
spring.datasource.url=${SPRING_DATASOURCE_URL:${JDBC_DATABASE_URL:jdbc:postgresql://${PGHOST:${POSTGRES_HOST:localhost}}:${PGPORT:${POSTGRES_PORT:5432}}/${PGDATABASE:${POSTGRES_DB:fitnessdb}}?sslmode=require}}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:${PGUSER:${POSTGRES_USER:postgres}}}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:${PGPASSWORD:${POSTGRES_PASSWORD:password}}}
spring.datasource.driver-class-name=org.postgresql.Driver

# Forcar o Hikari a usar a URL correta e nao tentar carregar valores padrao de exemplo
spring.datasource.hikari.jdbc-url=${spring.datasource.url}
spring.datasource.hikari.username=${spring.datasource.username}
spring.datasource.hikari.password=${spring.datasource.password}
spring.datasource.hikari.driver-class-name=org.postgresql.Driver

# JPA/Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.defer-datasource-initialization=false
spring.sql.init.mode=always
spring.sql.init.continue-on-error=true
spring.jpa.properties.hibernate.dialect=${SPRING_JPA_PROPERTIES_HIBERNATE_DIALECT:org.hibernate.dialect.PostgreSQLDialect}
spring.jpa.generate-ddl=true
spring.jpa.properties.hibernate.default_schema=public
spring.sql.init.platform=postgres

# HikariCP
spring.datasource.hikari.maximum-pool-size=${DB_POOL_SIZE:5}

# Port configuration
server.port=${PORT:8080}

# Logs
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
